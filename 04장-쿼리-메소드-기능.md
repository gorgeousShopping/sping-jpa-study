# 쿼리 메소드 기능

## 1. 메소드 이름으로 쿼리 생성

### 순수 JPA Repository

```java
public List<Chap4Member> findByUsernameAndAgeGreaterThan(String username, int age) {
    return em.createQuery("select m from Chap4Member m where m.username = :username and m.age > :age")
            .setParameter("username", username)
            .setParameter("age", age)
            .getResultList();
}
```

   

### Spring Data JPA Repository

```java
public interface Chap4MemberRepository extends JpaRepository<Member, Long> {
    List<Member> findByUsernameAndAgeGreaterThan(String username, int age);
}
```

- 메서드 이름으로 쿼리를 생성

- 위의 메서드는 `select m from Chap4Member m where m.username = :username and m.age > :age` 와 동일하며, 메서드의 매개변수로 넘어온 것으로 파라미터를 대신할 수 있음

- 메서드 이름 중 Entity의 필드명을 기반으로 쿼리를 생성하기 때문에 필드명을 주의해야 함
  필드명을 잘못 입력 혹은 변경시 컴파일 시점에`org.springframework.data.mapping.PropertyReferenceException: No property username2 found for type Member! Did you mean 'username'?` 이러한 에러와 함께 에러 확인이 가능함

  

### Spring Data JPA가 제공하는 쿼리 메소드 기능

[쿼리 생성 규칙 공식 문서](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation)를 참고

- 조회
  - find...By ,read...By ,query...By get...By,
  - ... 자리에는 식별하기 위한 내용이 들어가도 됨(아무거나 들어가도 됩니다.)
- COUNT
     - count...By 반환타입 long
- EXISTS
     - exists...By 반환타입 boolean
- 삭제
     - delete...By, remove...By 반환타입 long 
- DISTINCT
     - findDistinct, findMemberDistinctBy 
- LIMIT
     - findFirst3, findFirst, findTop, findTop3

쿼리 메소드는 편하긴 하지만, 조건이 많아지면 메서드 명이 길어지는 상황이 발생함. 이를 다양하게 해결하는 방법들 : NamedQuery, QueryDSL 등



